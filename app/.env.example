# =============================================================================
# RANSOMRUN - ELK SIEM Configuration
# =============================================================================
# Copy this file to .env and configure your Elasticsearch settings

# =============================================================================
# Elasticsearch Connection
# =============================================================================
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=changeme

# Optional: Use API Key instead of username/password
# ELASTICSEARCH_API_KEY=your-api-key-here

# SSL Verification (set to false for self-signed certs in lab environments)
ELASTICSEARCH_VERIFY_SSL=false

# =============================================================================
# Index Patterns
# =============================================================================
# Alerts index - where Elastic Security stores detection alerts
ELASTICSEARCH_INDEX_ALERTS=.alerts-security.alerts-*

# Logs index - where Winlogbeat/Filebeat/Elastic Agent store logs
# Supports multiple indices separated by commas
ELASTICSEARCH_INDEX_LOGS=logs-*,winlogbeat-*,filebeat-*

# Primary index for Sysmon/Winlogbeat events (used by detection engine)
ELK_INDEX=winlogbeat-*

# =============================================================================
# SIEM Mode
# =============================================================================
# "mock"    - Use simulated data for offline development (no ELK required)
# "elastic" - Connect to real Elasticsearch for live detection
SIEM_MODE=mock

# =============================================================================
# ELK Infrastructure Reference
# =============================================================================
# Elasticsearch: http://localhost:9200
# Logstash:      TCP 5044 (beats input)
# Kibana:        http://127.0.0.1:5601 (localhost-bound by default)
#
# To expose Kibana externally, edit kibana.yml:
#   server.host: "0.0.0.0"
#
# Expected log sources:
# - Winlogbeat (Windows Event Logs)
# - Sysmon (via Winlogbeat, event.provider = "Microsoft-Windows-Sysmon")
# - Filebeat (file-based logs)
# - Elastic Agent (unified agent)
#
# Sysmon Event IDs used by detection engine:
#   1  = Process Create
#   3  = Network Connection
#   10 = Process Access (LSASS)
#   11 = File Create

# =============================================================================
# Phishing Awareness Lab Configuration
# =============================================================================
# Enable/disable phishing simulation features
PHISHING_SIM_ENABLED=true

# Delivery mode: IN_APP (default) or MAIL_SINK (requires local mail server)
PHISHING_DELIVERY_MODE=IN_APP

# Enable local mail sink delivery (MailHog/smtp4dev/Papercut)
# WARNING: Only enable if you have a LOCAL mail sink running
ENABLE_LOCAL_MAIL_SINK=false

# Mail sink configuration (localhost only for safety)
MAILHOG_HOST=localhost
MAILHOG_PORT=1025

# Allowlisted email domains (comma-separated)
# Only emails from these domains can be used in campaigns
ALLOWLIST_DOMAINS=lab.local,example.local,test.local,ransomrun.local,training.local
